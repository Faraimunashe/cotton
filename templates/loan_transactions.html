{% extends "base.html" %}
{% block content %}
<div class="pagetitle">
    <h1>Loan Application History</h1>
      <nav>
          <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}">Home</a></li>
              <li class="breadcrumb-item active">Loan History</li>
          </ol>
      </nav>
  </div>
  <!-- End Page Title -->
<section class="section">
    <div class="row">
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% if "error" in messages[0] %}
                    <div class="alert alert-danger" role="alert">
                        <i class="fa fa-exclamation-triangle"></i>
                        {{messages[0]}}
                    </div>
                {% else %}
                    <div class="alert alert-success" role="alert">
                        <i class="fa fa-exclamation-triangle"></i>
                        {{messages[0]}}
                    </div>
                {% endif %}
            {% endif %}
        {% endwith %}
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body table-responsive">
                    <h5 class="card-title">Application History</h5>
                    <a href="{{url_for('generate_pdf')}}" class="btn btn-secondary"><i class="bi bi-printer"></i>Print</a>
                    <table class="table table-striped table-responsive">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Gender</th>
                                <th>Married</th>
                                <th>Dependents</th>
                                <th>Education</th>
                                <th>Self Employed</th>
                                <th>Application Income</th>
                                <th>Coapplication Income</th>
                                <th>Loan Amount</th>
                                <th>Loan Amount Term</th>
                                <th>Credit History</th>
                                <th>Property Area</th>
                                <th>Status</th>
                                <th>Created At</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for application, user in loan_applications %}
                                <tr>
                                    <td>{{ user.name }}</td>
                                    <td>{{ application.gender }}</td>
                                    <td>{{ application.married }}</td>
                                    <td>{{ application.dependents }}</td>
                                    <td>{{ application.education }}</td>
                                    <td>{{ application.self_employed }}</td>
                                    <td>{{ application.application_income }}</td>
                                    <td>{{ application.coapplication_income }}</td>
                                    <td>{{ application.loan_amount }}</td>
                                    <td>{{ application.loan_amount_term }}</td>
                                    <td>{{ application.credit_history }}</td>
                                    <td>{{ application.property_area }}</td>
                                    <td>{{ application.status }}</td>
                                    <td>{{ application.created_at }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}